# Development environment for speechBCI Language Model Decoder
FROM ubuntu:20.04

# Prevent interactive prompts during package installation
ENV DEBIAN_FRONTEND=noninteractive
ENV TZ=UTC

# Install system dependencies
RUN apt-get update && apt-get install -y \
    # Build essentials
    build-essential \
    cmake \
    git \
    wget \
    curl \
    unzip \
    pkg-config \
    # Python development
    python3 \
    python3-dev \
    python3-pip \
    python3-venv \
    # C++ development
    g++ \
    clang \
    gdb \
    # Libraries needed for the project
    libssl-dev \
    zlib1g-dev \
    libbz2-dev \
    libreadline-dev \
    libsqlite3-dev \
    libncurses5-dev \
    libncursesw5-dev \
    libffi-dev \
    liblzma-dev \
    # Additional tools
    vim \
    nano \
    htop \
    tree \
    # Clean up
    && rm -rf /var/lib/apt/lists/*

# Install Python packages
RUN pip3 install --upgrade pip setuptools wheel

# Install common Python development packages
RUN pip3 install \
    numpy \
    scipy \
    matplotlib \
    jupyter \
    ipython \
    pytest \
    black \
    flake8 \
    mypy

# Set up working directory
WORKDIR /workspace

# Create a non-root user for development
RUN useradd -m -s /bin/bash developer && \
    usermod -aG sudo developer && \
    echo "developer ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

# Switch to developer user
USER developer

# Set up shell environment
RUN echo 'export PS1="\[\033[01;32m\]\u@speechbci-dev\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ "' >> ~/.bashrc

# Default command
CMD ["/bin/bash"]
